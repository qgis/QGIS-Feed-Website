{% extends 'layouts/base-fullscreen.html' %}
{% block title %} QGIS Home Page News Feed {% endblock title %} {% load static %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
    .box-container {
        max-width: 1200px;
    }

    .hoverable-preview:hover {
        cursor: pointer;
        background: #d4d4d4 !important;
    }

    #tab-content div.is-active {
        display: block;
    }

    #tab-content div.is-inactive {
        display: none;
    }

    code {
        border-radius: 5px;
        white-space: pre-wrap;
    }
</style>
{% endblock stylesheets %}
{% block pagetitle %}
{% include "layouts/page-title.html" with page_title='QGIS Feed' %}
{% endblock %}
{% block content %}

<div>
    <div class="tabs is-centered" id="tabs">
        <ul>
            <li>
                <a class="is-active" data-tab="1">
                    <span class="icon is-small"><i class="fa fa-image"></i></span>
                    <span>Preview</span>
                </a>
            </li>
            <li>
                <a data-tab="2">
                    <span class="icon is-small"><i class="fa fa-code"></i></span>
                    <span>Raw</span>
                </a>
            </li>
        </ul>
    </div>
    <div id="tab-content">
        <div class="tab-content-element is-active" style="padding:0 10px;" data-content="1">
            {% if data|length > 0 %}
            {% for feed in data %}
            <div class="box-container hoverable-preview form-preview columns has-background-light p-2 mt-5"
                onclick="window.location.href='{% url 'feed_detail' feed.pk %}';" style="margin-left: auto;margin-right: auto;">
                <div class="column is-4 is-flex is-flex-direction-column is-align-items-center"
                    name="imagePreview">
                    {% if feed.image %}
                    <img src="{{ feed.image }}" style="border-radius:20px;">
                    {% endif %}
                </div>
                <div class="column is-8">
                    <h5 name="titlePreview" class="title is-5">
                        {{feed.title | default:""}}
                    </h5>
                    <div name="contentPreview">
                        {{feed.content | default:"" | safe }}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div style="width: 100%; text-align: center;" class="m-5">
                No data found
            </div>
            {% endif %}
        </div>
        <div class="tab-content-element is-inactive" data-content="2">
            <pre style="background-color:unset; padding:0;">
                <code class="language-json">{{data_json}}</code>
            </pre>
        </div>
    </div>
</div>
{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
<script>
    $(document).ready(function () {
        $('#tabs li a').on('click', function () {
            var tab = $(this).data('tab');

            $('#tabs li a').removeClass('is-active');
            $(this).addClass('is-active');

            $('.tab-content-element').removeClass('is-active');
            $('.tab-content-element').addClass('is-inactive');
            $('div[data-content="' + tab + '"]').removeClass('is-inactive');
            $('div[data-content="' + tab + '"]').addClass('is-active');
        });

    });
</script>
{% endblock javascripts %}